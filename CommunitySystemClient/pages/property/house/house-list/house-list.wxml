<!-- pages/property/house/house-list/house-list.wxml -->

<view class="page">
  <!-- æœç´¢æ  -->
  <view class="search-container">
    <view class="search-bar">
      <input 
        class="search-input" 
        type="text" 
        placeholder="è¾“å…¥æˆ¿äº§å·æœç´¢"
        bindinput="onSearchInput"
        value="{{searchKeyword}}"
      />
      <button class="search-btn" bindtap="handleSearch">æœç´¢</button>
    </view>
  </view>

  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="status-filter-container">
    <view class="filter-bar">
      <view class="filter-tag" bindtap="setStatusFilter" data-status="">
        <view class="tag-text {{statusFilter === '' ? 'active' : ''}}">å…¨éƒ¨çŠ¶æ€</view>
      </view>
      <view class="filter-tag" bindtap="setStatusFilter" data-status="ç©ºç½®">
        <view class="tag-text {{statusFilter === 'ç©ºç½®' ? 'active' : ''}}">ç©ºç½®</view>
      </view>
      <view class="filter-tag" bindtap="setStatusFilter" data-status="å·²å”®">
        <view class="tag-text {{statusFilter === 'å·²å”®' ? 'active' : ''}}">å·²å”®</view>
      </view>
      <view class="filter-tag" bindtap="setStatusFilter" data-status="å·²ç§Ÿ">
        <view class="tag-text {{statusFilter === 'å·²ç§Ÿ' ? 'active' : ''}}">å·²ç§Ÿ</view>
      </view>
      <view class="filter-tag" bindtap="setStatusFilter" data-status="ç»´ä¿®">
        <view class="tag-text {{statusFilter === 'ç»´ä¿®' ? 'active' : ''}}">ç»´ä¿®</view>
      </view>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="content">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading" wx:if="{{loading && page === 1}}">
      <view class="loading-spinner"></view>
      <view class="loading-text">åŠ è½½ä¸­...</view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{empty && !loading}}">
      <view class="empty-icon">ğŸ </view>
      <view class="empty-text">æš‚æ— æˆ¿äº§æ•°æ®</view>
    </view>

    <!-- æˆ¿äº§åˆ—è¡¨ -->
    <view class="house-list" wx:if="{{!loading && !empty}}">
      <view class="house-item" wx:for="{{houses}}" wx:key="id">
        <!-- å¯ç‚¹å‡»çš„å¡ç‰‡åŒºåŸŸ -->
        <view class="house-card" bindtap="viewDetails" data-id="{{item.id}}">
          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <view class="card-header">
            <view class="property-number">{{item.roomNo || item.propertyNumber}}</view>
            <view class="property-status {{item.houseStatus === 'å·²å”®' ? 'sold' : item.houseStatus === 'å·²ç§Ÿ' ? 'rented' : item.houseStatus === 'ç»´ä¿®' ? 'maintenance' : 'empty'}}" wx:if="{{item.houseStatus}}">
              {{item.houseStatus}}
            </view>
          </view>

          <!-- å¡ç‰‡å†…å®¹ -->
          <view class="card-content">
            <view class="info-item">
              <view class="label">æˆ¿å±‹ç±»å‹</view>
              <view class="value">{{item.houseType || item.propertyType || '-'}}</view>
            </view>
            <view class="info-item">
              <view class="label">æˆ·å‹</view>
              <view class="value">{{item.houseLayout || '-'}}</view>
            </view>
            <view class="info-item">
              <view class="label">ä¸šä¸»</view>
              <view class="value">{{item.ownerName || 'æœªå…³è”'}}</view>
            </view>
            <view class="info-item">
              <view class="label">å»ºç­‘é¢ç§¯</view>
              <view class="value">{{item.buildingArea || item.area || '-'}} mÂ²</view>
            </view>
            <view class="info-item">
              <view class="label">å¯ç”¨é¢ç§¯</view>
              <view class="value">{{item.usableArea || '-'}} mÂ²</view>
            </view>
            <!-- <view class="info-item">
              <view class="label">æœå‘</view>
              <view class="value">{{item.houseOrientation || '-'}}</view>
            </view>
            <view class="info-item">
              <view class="label">æ¥¼å±‚</view>
              <view class="value">{{item.floorLevel || item.floor || '-'}}</view>
            </view> -->
          </view>
        </view>

        <!-- æ“ä½œæŒ‰é’® - å•ç‹¬æ”¾åœ¨å¡ç‰‡å¤– -->
        <view class="card-actions">
          <button class="action-btn edit-btn" bindtap="editHouse" data-id="{{item.id}}" hover-class="btn-hover">ä¿®æ”¹</button>
          <button class="action-btn delete-btn" bindtap="deleteHouse" data-id="{{item.id}}" hover-class="btn-hover">åˆ é™¤</button>
        </view>
      </view>
    </view>

    <!-- åŠ è½½å®Œæˆæç¤º -->
    <view class="load-complete" wx:if="{{!hasMore && houses.length > 0 && !loading}}">
      å·²åŠ è½½å…¨éƒ¨
    </view>
  </view>
</view>
