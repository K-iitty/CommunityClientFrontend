<!-- pages/property/notice/list/list.wxml -->
<!-- å…¬å‘Šç®¡ç† - åˆ—è¡¨é¡µé¢ -->

<view class="page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <!-- <view class="header">
    <view class="header-title">å…¬å‘Šç®¡ç†</view>
    <view class="header-subtitle">ç¤¾åŒºé€šçŸ¥å’Œå…¬å‘Š</view>
  </view> -->

  <!-- æœç´¢æ  -->
  <view class="search-container">
    <view class="search-bar">
      <input
        type="text"
        class="search-input"
        placeholder="æœç´¢å…¬å‘Šæ ‡é¢˜"
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
      <button class="search-btn" bindtap="handleSearch">æœç´¢</button>
      <button class="clear-btn" bindtap="clearSearch" wx:if="{{searchKeyword}}">æ¸…é™¤</button>
    </view>
  </view>

  <!-- åˆ†ç±»ç­›é€‰ -->
  <view class="filter-tags">
    <block wx:for="{{categories}}" wx:key="id">
      <view
        class="filter-tag {{categoryFilter === item.id ? 'active' : ''}}"
        data-category="{{item.id}}"
        bindtap="setCategory"
      >
        {{item.name}}
      </view>
    </block>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content">
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{empty && !loading}}" class="empty-state">
      <view class="empty-icon">ğŸ“‹</view>
      <view class="empty-text">æš‚æ— å…¬å‘Š</view>
      <view class="empty-tip">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å‘å¸ƒæ–°å…¬å‘Š</view>
    </view>

    <!-- å…¬å‘Šåˆ—è¡¨ -->
    <view wx:else class="notice-list">
      <block wx:for="{{filteredNotices}}" wx:key="noticeId">
        <!-- å…¬å‘Šå¡ç‰‡ -->
        <view class="notice-card" bindtap="viewDetail" data-id="{{item.id}}">
          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <view class="card-header">
            <view class="notice-title">{{item.title || item.noticeTitle || '-'}}</view>
            <view class="category-badge {{item.noticeType}} {{item.status === 'å·²å‘å¸ƒ' ? 'published' : 'draft'}}">
              {{item.noticeType || item.category || 'å…¬å‘Š'}}
            </view>
          </view>

          <!-- å¡ç‰‡å†…å®¹ -->
          <view class="card-content">
            <!-- å†…å®¹é¢„è§ˆ -->
            <!-- <view class="notice-summary">
              {{item.content || item.noticeContent || 'æ— å†…å®¹æè¿°'}}
            </view> -->

            <!-- å…ƒä¿¡æ¯ -->
            <view class="notice-meta">
              <view class="publish-time">
                {{item.publishTime || item.createTime || 'æœªçŸ¥'}}
              </view>
              <view class="read-count">
                é˜…è¯»: {{item.readCount || 0}}
              </view>
              <!-- <view class="status-label {{item.status}}">
                {{item.status || 'å·²å‘å¸ƒ'}}
              </view> -->
            </view>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="card-actions">
            <button class="action-btn edit-btn" data-id="{{item.id}}" bindtap="editNotice" catch:tap>ç¼–è¾‘</button>
            <button class="action-btn delete-btn" data-id="{{item.id}}" bindtap="deleteNotice" catch:tap>åˆ é™¤</button>
          </view>
        </view>
      </block>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading && notices.length === 0}}" class="loading">
      åŠ è½½ä¸­...
    </view>

    <!-- åŠ è½½å®Œæˆ -->
    <view wx:if="{{!hasMore && filteredNotices.length > 0}}" class="load-complete">
      å·²åŠ è½½å…¨éƒ¨å…¬å‘Š
    </view>
  </view>

  <!-- æ–°å¢å…¬å‘ŠæŒ‰é’® -->
  <view class="add-button-container">
    <button class="add-button" bindtap="goToAdd">
      å‘å¸ƒæ–°å…¬å‘Š
    </button>
  </view>
</view>