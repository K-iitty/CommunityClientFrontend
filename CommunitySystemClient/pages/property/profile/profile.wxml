<!-- pages/property/profile/profile.wxml -->
<!-- å‘˜å·¥èµ„æ–™ç®¡ç† - ä¸ªäººèµ„æ–™é¡µé¢ -->

<view class="page">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <view class="loading-spinner"></view>
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{empty && !loading}}" class="empty-state">
    <view class="empty-icon">ğŸ‘¤</view>
    <view class="empty-text">åŠ è½½å¤±è´¥</view>
    <button class="retry-btn" bindtap="loadStaffProfile">é‡è¯•</button>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view wx:if="{{staff && !loading}}" class="content">
    <!-- å‘˜å·¥å¤´éƒ¨ä¿¡æ¯å¡ç‰‡ -->
    <view class="staff-header">
      <!-- å¤´åƒå’ŒåŸºæœ¬ä¿¡æ¯ -->
      <view class="header-content">
        <view class="avatar">ğŸ‘¤</view>
        <view class="info">
          <view class="name">{{staff.name}}</view>
          <view class="position" style="color: {{getPositionColor(staff.position)}}">
            {{staff.position || 'å‘˜å·¥'}}
          </view>
          <view class="department">{{(staff.department && staff.department.departmentName) || 'éƒ¨é—¨æœªçŸ¥'}}</view>
        </view>
      </view>
      <!-- è´¦æˆ·çŠ¶æ€å¾½ç«  -->
      <view class="status-badge" style="background-color: {{staff.accountStatus === 'æ­£å¸¸' ? '#10b981' : '#ef4444'}}">
        {{staff.accountStatus || 'æ­£å¸¸'}}
      </view>
    </view>

    <!-- åŸºç¡€ä¿¡æ¯åŒº -->
    <view class="info-section">
      <view class="section-title">åŸºç¡€ä¿¡æ¯</view>
      
      <view class="info-grid">
        <view class="info-item">
          <view class="label">å§“å</view>
          <view class="value">{{staff.name || '-'}}</view>
        </view>
        
        <view class="info-item">
          <view class="label">è´¦å·</view>
          <view class="value">{{staff.username || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å‘˜å·¥ID</view>
          <view class="value">{{staff.id || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å·¥ä½œå·</view>
          <view class="value">{{staff.workNo || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">æ€§åˆ«</view>
          <view class="value">{{staff.gender || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å‡ºç”Ÿæ—¥æœŸ</view>
          <view class="value">{{staff.birthDate || '-'}}</view>
        </view>
      </view>
    </view>

    <!-- è”ç³»æ–¹å¼åŒº -->
    <view class="info-section">
      <view class="section-title">è”ç³»æ–¹å¼</view>
      
      <view class="info-grid">
        <view class="info-item">
          <view class="label">ç”µè¯</view>
          <view class="value">{{staff.phone || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">é‚®ç®±</view>
          <view class="value">{{staff.email || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å¾®ä¿¡</view>
          <view class="value">{{staff.wechat || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">åŠå…¬ç”µè¯</view>
          <view class="value">{{staff.telephoneAreaCode}}-{{staff.telephoneNumber}}{{staff.telephoneExtension ? '-' + staff.telephoneExtension : ''}}</view>
        </view>

        <view class="info-item">
          <view class="label">ç´§æ€¥è”ç³»äºº</view>
          <view class="value">{{staff.emergencyContact || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">ç´§æ€¥ç”µè¯</view>
          <view class="value">{{staff.emergencyPhone || '-'}}</view>
        </view>
      </view>
    </view>

    <!-- å·¥ä½œä¿¡æ¯åŒº -->
    <view class="info-section">
      <view class="section-title">å·¥ä½œä¿¡æ¯</view>
      
      <view class="info-grid">
        <view class="info-item">
          <view class="label">éƒ¨é—¨</view>
          <view class="value">{{(staff.department && staff.department.departmentName) || 'æœªåˆ†é…'}}</view>
        </view>

        <view class="info-item">
          <view class="label">éƒ¨é—¨ç¼–ç </view>
          <view class="value">{{(staff.department && staff.department.departmentCode) || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">èŒä½</view>
          <view class="value" style="color: {{getPositionColor(staff.position)}}">
            {{staff.position || 'å‘˜å·¥'}}
          </view>
        </view>

        <view class="info-item">
          <view class="label">èŒåŠ¡</view>
          <view class="value">{{staff.jobTitle || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å…¥èŒæ—¥æœŸ</view>
          <view class="value">{{staff.hireDate || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">å·¥ä½œçŠ¶æ€</view>
          <view class="value" style="color: {{staff.workStatus === 'åœ¨èŒ' ? '#10b981' : '#ef4444'}}">
            {{staff.workStatus || 'åœ¨èŒ'}}
          </view>
        </view>

        <view class="info-item">
          <view class="label">æ˜¯å¦ç®¡ç†è€…</view>
          <view class="value">{{staff.isManager ? 'æ˜¯' : 'å¦'}}</view>
        </view>
      </view>
    </view>

    <!-- æ•™è‚²èƒŒæ™¯åŒº -->
    <view class="info-section">
      <view class="section-title">æ•™è‚²èƒŒæ™¯</view>
      
      <view class="info-grid">
        <view class="info-item">
          <view class="label">å­¦å†</view>
          <view class="value">{{staff.educationLevel || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">æ¯•ä¸šé™¢æ ¡</view>
          <view class="value">{{staff.graduateSchool || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">æ‰€å­¦ä¸“ä¸š</view>
          <view class="value">{{staff.major || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">æ¯•ä¸šæ—¥æœŸ</view>
          <view class="value">{{staff.graduationDate || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">ç±è´¯</view>
          <view class="value">{{staff.nativePlace || '-'}}</view>
        </view>
      </view>
    </view>

    <!-- è´¦æˆ·ä¿¡æ¯åŒº -->
    <view class="info-section">
      <view class="section-title">è¯ä»¶ç…§ç‰‡</view>
      
      <!-- èº«ä»½è¯ç…§ç‰‡ -->
      <view class="photo-subsection" wx:if="{{staff.idCardPhotos}}">
        <view class="photo-label">èº«ä»½è¯ç…§ç‰‡</view>
        <view class="photo-grid">
          <view class="photo-item" bindtap="previewImage" data-url="{{staff.idCardPhotos}}" data-type="idCard">
            <image src="{{staff.idCardPhotos}}" mode="aspectFill" class="photo-image"></image>
            <view class="photo-overlay">æŸ¥çœ‹</view>
          </view>
        </view>
      </view>

      <!-- è¯ä»¶ç…§ -->
      <view class="photo-subsection" wx:if="{{staff.certificatePhotos}}">
        <view class="photo-label">è¯ä»¶ç…§</view>
        <view class="photo-grid">
          <view class="photo-item" bindtap="previewImage" data-url="{{staff.certificatePhotos}}" data-type="certificate">
            <image src="{{staff.certificatePhotos}}" mode="aspectFill" class="photo-image"></image>
            <view class="photo-overlay">æŸ¥çœ‹</view>
          </view>
        </view>
      </view>
    </view>

    <!-- è´¦æˆ·ä¿¡æ¯åŒº -->
    <view class="info-section">
      <view class="section-title">è´¦æˆ·ä¿¡æ¯</view>
      
      <view class="info-grid">
        <view class="info-item">
          <view class="label">èº«ä»½è¯</view>
          <view class="value">{{staff.idCard || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">è´¦æˆ·çŠ¶æ€</view>
          <view class="value" style="color: {{staff.accountStatus === 'æ­£å¸¸' ? '#10b981' : '#ef4444'}}">
            {{staff.accountStatus || 'æ­£å¸¸'}}
          </view>
        </view>

        <view class="info-item">
          <view class="label">ç™»å½•æ¬¡æ•°</view>
          <view class="value">{{staff.loginCount || 0}}</view>
        </view>

        <view class="info-item">
          <view class="label">æœ€åç™»å½•</view>
          <view class="value">{{staff.lastLoginTime || 'æœªç™»å½•'}}</view>
        </view>

        <view class="info-item">
          <view class="label">æœ€åç™»å½•IP</view>
          <view class="value">{{staff.lastLoginIp || '-'}}</view>
        </view>

        <view class="info-item">
          <view class="label">åœ¨çº¿çŠ¶æ€</view>
          <view class="value" style="color: {{staff.onlineStatus ? '#10b981' : '#ef4444'}}">
            {{staff.onlineStatus ? 'åœ¨çº¿' : 'ç¦»çº¿'}}
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œèœå• -->
    <view class="menu-section">
      <view class="section-title">æ“ä½œ</view>
      <view class="menu-grid">
        <block wx:for="{{menuItems}}" wx:key="id">
          <view 
            class="menu-item" 
            data-id="{{item.id}}"
            bindtap="handleMenuClick"
          >
            <view class="menu-label">{{item.label}}</view>
          </view>
        </block>
      </view>
        <!-- é€€å‡ºç™»é™†æŒ‰é’® -->
       <view>
          <button class="outlog-button" bindtap="handleLogout">é€€å‡ºç™»å½•</button>
       </view> 
    </view>
  </view>
</view>